{% extends "base.html" %}

{% block title %}Select Commander - MTG Deck Optimizer{% endblock %}

{% block content %}
<h2>Select Your Commander</h2>
<p>Choose a commander from your collection to generate a deck:</p>

{% if commanders %}
<form method="POST" id="commanderForm">
    <div class="commander-grid">
        {% for commander in commanders %}
        <div class="commander-card" onclick="selectCommander('{{ commander['Scryfall ID'] }}', this)">
            <h3>{{ commander.name }}</h3>
            <p><strong>Type:</strong> {{ commander.type_line }}</p>
            <p><strong>Mana Cost:</strong> {{ commander.mana_cost or 'N/A' }}</p>
            <p><strong>CMC:</strong> {{ commander.cmc or 0 }}</p>
            <p class="color-identity">
                <strong>Color Identity:</strong> 
                {% if commander.color_identity %}
                    {{ commander.color_identity | join(', ') }}
                {% else %}
                    Colorless
                {% endif %}
            </p>
            {% if commander.power and commander.toughness %}
            <p><strong>P/T:</strong> {{ commander.power }}/{{ commander.toughness }}</p>
            {% endif %}
            {% if commander.oracle_text %}
            <p><strong>Text:</strong> {{ commander.oracle_text[:100] }}{% if commander.oracle_text|length > 100 %}...{% endif %}</p>
            {% endif %}
        </div>
        {% endfor %}
    </div>
    
    <input type="hidden" name="commander_id" id="selectedCommanderId">
    <button type="submit" class="btn" id="generateBtn" disabled>Generate Deck</button>
</form>
{% else %}
<p>No commanders found in your collection. Make sure you have legendary creatures that are legal in Commander format.</p>
<a href="/download-data" class="btn">Download Latest Card Data</a>
{% endif %}

<script>
function selectCommander(commanderId, element) {
    // Remove previous selections
    document.querySelectorAll('.commander-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // Select this card
    element.classList.add('selected');
    
    // Set the hidden input value
    document.getElementById('selectedCommanderId').value = commanderId;
    
    // Enable the generate button
    document.getElementById('generateBtn').disabled = false;
}
</script>
{% endblock %}
